## This is reproducer (clang -g -O0 m.c -o m)
## void crash(int val, int* adr){
##        *adr = val; // crash - line 3
## }
##
## void blame(int** ptr, int* adr){
##        *ptr = adr; // wrong blame - line 7
## }
##
## void fun(int** ptr, int* adr)
## {
##    blame(ptr,adr);
## }
##
## int main(){
##  int *adr = 3; // correct blame - line 16
##  int *p = 0; // wrong blame - line 17
##  fun(&p,adr);
##  crash(1, p);
##  return 0;
## }

## In this case, we test TaintAnalysis of functions out of the backtrace, where
## parameters are tainted (references to the tainted location) and are forwarded
## through registers.


# RUN: %llvm-crash-analyzer --print-potential-crash-cause-loc --debug-only=taint-dfg \
# RUN: --core-file=%S/Inputs/core.tainted-params-outside-blame %S/Inputs/tainted-params-outside-blame.out < %s 2>&1 | FileCheck %s

# CHECK: Blame Nodes:
# CHECK-NEXT: !21{2; $eax = MOV32ri 3; CONSTANT: 3; DEREF-LVL: 0}
# CHECK-NEXT: Blame line: 16
# CHECK-NEXT: !19{2; MOV64mi32 $rbp, 1, $noreg, -24, $noreg, 0; CONSTANT: 0; DEREF-LVL: 0}
# CHECK-NEXT: Blame line: 17

# CHECK: Blame Function is main
# CHECK-NEXT: From File {{.*}}/m.c:16:8
